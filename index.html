<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>The Story of Us 💙</title>
  <style>
    /* (Include all your existing CSS as before, including body, header, timeline, modal, sparkle-canvas, etc.) */
    body { margin: 0; background-color: #000; font-family: 'Segoe UI', sans-serif; color: white; overflow-x: hidden; }
    /* ... all your existing styles, including sparkle-canvas, modal-content z-index, floating-emoji, media queries, etc. */
  </style>
</head>
<body>
  <img src="images/moon.png" id="moon" alt="Moon">
  <canvas id="starCanvas"></canvas>

  <audio id="bg-music" loop>
    <source src="ylimd8bit.mp3" type="audio/mpeg" />
  </audio>

  <div class="floating-bg">
    <!-- background images -->
    <img src="images/sc1.png" class="bg-image" style="top: 26%; left: 9%;" alt="Snapchat 1" />
    <!-- ... other background images ... -->
  </div>

  <div id="ringModal" onclick="closeModal()">
    <img src="images/ring.png" alt="Promise Ring">
  </div>

  <header>
    <h1>🌌 The Story of Us 😼💍</h1>
    <p>From Roblox to Rings and Ridiculous Laughs</p>
  </header>

  <div class="timeline">
    <!-- your event blocks -->
    <div class="event"><h3>📅 Feb 8</h3><p>We met. Chaos and love were born 😎</p></div>
    <!-- ... rest of events ... -->
  </div>

  <div id="promise">
    <h2>💍 My Promise</h2>
    <p>This isn’t just a ring. It’s the moment I said: “You're it for me.” … Always. 🙏😭🌝💖</p>
  </div>

  <div class="reveal-container">
    <button class="music-button" onclick="document.getElementById('bg-music').play()">▶️ Play Our Song</button>
    <button class="reveal-button" id="revealBtn">💖 Click to Reveal Your Ring 💖</button>
    <img id="ringRevealFinal" src="images/ring.png" alt="Promise Ring Final Position">
    <button class="love-letter-button" onclick="openLoveLetter()">💌 Read My Love Letter</button>
  </div>

  <div class="footer">
    Made with croissants, Monster cans, and love. 🍪💘
  </div>

  <div id="loveLetterModal" class="modal" onclick="closeLoveLetter()">
    <canvas id="sparkleCanvas" class="sparkle-canvas"></canvas>
    <div class="modal-content" onclick="event.stopPropagation()">
      <h2>💌 To My Triniti</h2>
      <p>
        Every moment with you feels like stardust in my chest. …
        — Naimul
      </p>
    </div>
  </div>

  <script>
    const emojis = ["😼","🙀","💍","💞","🌝","😍","😭","😔","🖤","😡","🎮","🤍","😁","😘","💖","😜","😞","😩","🤣","💝","🤩","🥺","👿","💘","🤟","🤰","🧡","💉","💎","💫","💻","🚀","🚗","💕","🐎","🏍️"];

    function spawnEmojis() {
      document.querySelectorAll('.floating-emoji').forEach(e => e.remove());
      for (let i = 0; i < 25; i++) {
        const emoji = document.createElement("div");
        emoji.className = "floating-emoji";
        emoji.style.left = (5 + Math.random() * 90) + "vw";
        emoji.style.animationDuration = (6 + Math.random() * 3) + "s";
        emoji.style.top = "100vh";
        emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
        document.body.appendChild(emoji);
      }
    }

    function closeModal() {
      document.getElementById('ringModal').style.display = 'none';
      document.getElementById('ringRevealFinal').style.display = 'block';
      spawnEmojis();
    }

    document.addEventListener("DOMContentLoaded", () => {
      spawnEmojis();
      document.getElementById("revealBtn").addEventListener("click", () => {
        document.getElementById("ringModal").style.display = 'flex';
      });
    });

    // === Sparkles setup ===
    let sparkleCanvas, sparkleCtx, sparkles = [];

    function resizeSparkleCanvas() {
      if (!sparkleCanvas) return;
      sparkleCanvas.width = sparkleCanvas.offsetWidth;
      sparkleCanvas.height = sparkleCanvas.offsetHeight;
    }

    function createSparkle() {
      return {
        x: Math.random() * sparkleCanvas.width,
        y: Math.random() * sparkleCanvas.height,
        radius: Math.random() * 1.5 + 0.5,
        opacity: Math.random() * 0.5 + 0.5,
        speedY: Math.random() * 0.5 + 0.2,
        life: 0,
        maxLife: 80 + Math.random() * 20
      };
    }

    function drawSparkles() {
      if (!sparkleCtx) return;
      sparkleCtx.clearRect(0, 0, sparkleCanvas.width, sparkleCanvas.height);
      sparkles.forEach((s, i) => {
        sparkleCtx.beginPath();
        sparkleCtx.arc(s.x, s.y, s.radius, 0, Math.PI * 2);
        sparkleCtx.fillStyle = `rgba(255, 255, 255, ${s.opacity})`;
        sparkleCtx.fill();
        s.y -= s.speedY;
        s.life++;
        if (s.life > s.maxLife) sparkles[i] = createSparkle();
      });
      requestAnimationFrame(drawSparkles);
    }

    function startSparkles() {
      sparkleCanvas = document.getElementById("sparkleCanvas");
      if (!sparkleCanvas) return;
      sparkleCtx = sparkleCanvas.getContext("2d");
      resizeSparkleCanvas();
      sparkles = Array.from({ length: 50 }, createSparkle);
      drawSparkles();
    }

    function openLoveLetter() {
      document.getElementById("loveLetterModal").style.display = 'flex';
      setTimeout(startSparkles, 100);
    }

    function closeLoveLetter() {
      document.getElementById("loveLetterModal").style.display = 'none';
    }

    window.addEventListener("resize", () => {
      resizeSparkleCanvas();
    });

    // === Starry Background and shooting stars ===
    const starCanvas = document.getElementById("starCanvas");
    const starCtx = starCanvas.getContext("2d");
    let stars = [], shootingStars = [];

    function resizeStarCanvas() {
      starCanvas.width = window.innerWidth;
      starCanvas.height = window.innerHeight;
    }

    function createStars() {
      stars = [];
      for (let i = 0; i < 100; i++) {
        stars.push({
          x: Math.random() * starCanvas.width,
          y: Math.random() * starCanvas.height,
          radius: Math.random() * 1.5 + 0.5,
          alpha: 1 + Math.random() * 0.75,
          delta: Math.random() * 0.02 + 0.005,
        });
      }
    }

    function drawStars() {
      starCtx.clearRect(0, 0, starCanvas.width, starCanvas.height);
      stars.forEach(star => {
        star.alpha += star.delta;
        if (star.alpha <= 0 || star.alpha >= 1) star.delta *= -1;
        starCtx.beginPath();
        starCtx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
        starCtx.fillStyle = `rgba(255,255,255,${star.alpha})`;
        starCtx.fill();
      });

      for (let i = shootingStars.length - 1; i >= 0; i--) {
        const s = shootingStars[i];
        s.x += s.speed; s.y += s.speed; s.life++;
        starCtx.beginPath();
        starCtx.moveTo(s.x, s.y);
        starCtx.lineTo(s.x - s.length, s.y - s.length);
        starCtx.strokeStyle = "white";
        starCtx.lineWidth = 2;
        starCtx.stroke();
        if (s.life > s.maxLife) shootingStars.splice(i, 1);
      }

      if (Math.random() < 0.04) {
        shootingStars.push({
          x: Math.random() * starCanvas.width,
          y: Math.random() * starCanvas.height * 0.5,
          length: Math.random() * 80 + 100,
          speed: Math.random() * 8 + 10,
          life: 0,
          maxLife: 30 + Math.random() * 10
        });
      }
      requestAnimationFrame(drawStars);
    }

    window.addEventListener("resize", () => {
      resizeStarCanvas();
      createStars();
    });

    resizeStarCanvas();
    createStars();
    drawStars();
  </script>
</body>
</html>
